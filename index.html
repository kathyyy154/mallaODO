<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Interactiva Odontología UDP</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Malla Interactiva Odontología UDP</h1>
  <button onclick="reiniciarMalla()">Reiniciar malla</button>

  <div class="malla">
    <!-- Cabecera de semestres -->
    <div class="sem-titulo">1°</div>
    <div class="sem-titulo">2°</div>
    <div class="sem-titulo">3°</div>
    <div class="sem-titulo">4°</div>
    <div class="sem-titulo">5°</div>
    <div class="sem-titulo">6°</div>
    <div class="sem-titulo">7°</div>
    <div class="sem-titulo">8°</div>
    <div class="sem-titulo">9°</div>
    <div class="sem-titulo">10°</div>
    <div class="sem-titulo">11°</div>
    <div class="sem-titulo">12°</div>

    <!-- 1° semestre -->
    <div class="ramo" id="morfo1" data-col="1" data-row="1">Morfofunción I</div>
    <div class="ramo" id="matematicas" data-col="1" data-row="2">Matemáticas</div>
    <div class="ramo" id="biologia" data-col="1" data-row="3">Biología</div>
    <div class="ramo" id="quimica" data-col="1" data-row="4">Química General</div>
    <div class="ramo" id="intro" data-col="1" data-row="5">Introducción a la Odontología</div>

    <!-- 2° semestre -->
    <div class="ramo" id="morfo2" data-col="2" data-row="1" data-prer="morfo1">Morfofunción II</div>
    <div class="ramo" id="biofisica" data-col="2" data-row="2" data-prer="matematicas">Biofísica</div>
    <div class="ramo" id="bioquimica" data-col="2" data-row="3" data-prer="biologia,quimica">Bioquímica</div>
    <div class="ramo" id="habilidades" data-col="2" data-row="4" data-prer="intro">Habilidades y Destrezas Odontológicas</div>

    <!-- 3° semestre -->
    <div class="ramo" id="anatomia" data-col="3" data-row="1" data-prer="morfo2">Anatomía Aplicada</div>
    <div class="ramo" id="micro1" data-col="3" data-row="2" data-prer="morfo2,bioquimica">Microbiología y Parasitología</div>
    <div class="ramo" id="patogeneral" data-col="3" data-row="3" data-prer="morfo2">Patología General</div>
    <div class="ramo" id="bioetica" data-col="3" data-row="4" data-prer="intro">Bioética</div>
    <div class="ramo doble" id="preclinico" data-col="3" data-row="5" data-prer="biofisica,habilidades">Preclínico y Biomateriales Dentales</div>

    <!-- 4° semestre -->
    <div class="ramo" id="microoral" data-col="4" data-row="1" data-prer="micro1">Microbiología Oral</div>
    <div class="ramo" id="protradio" data-col="4" data-row="2" data-prer="biofisica">Protección Radiológica</div>
    <div class="ramo" id="patooral1" data-col="4" data-row="3" data-prer="patogeneral">Patología Oral I</div>
    <div class="ramo" id="epidemio" data-col="4" data-row="4" data-prer="matematicas">Epidemiología</div>

    <!-- 5° semestre -->
    <div class="ramo" id="imagen1" data-col="5" data-row="1" data-prer="anatomia,protradio">Diagnóstico por Imágenes I</div>
    <div class="ramo" id="patooral2" data-col="5" data-row="3" data-prer="patooral1,microoral">Patología Oral II</div>
    <div class="ramo doble" id="farmaco" data-col="5" data-row="2" data-prer="microoral,patooral1">Farmacología General y Clínica</div>
    <div class="ramo doble" id="rehabili" data-col="5" data-row="4" data-prer="anatomia,preclinico,microoral">Preclínico de Rehabilitación y Cariología</div>
    <div class="ramo doble" id="cirubucal" data-col="5" data-row="5" data-prer="microoral,patooral1,anatomia">Cirugía Bucal</div>
    <div class="ramo doble" id="oclusion" data-col="5" data-row="6" data-prer="anatomia,preclinico">Oclusión y Trastornos Temporomandibulares</div>

    <!-- 6° semestre -->
    <div class="ramo" id="imagen2" data-col="6" data-row="1" data-prer="imagen1">Diagnóstico por Imágenes II</div>
    <div class="ramo" id="patooral3" data-col="6" data-row="3" data-prer="patooral2">Patología Oral III</div>
    
    <!-- 7° semestre -->
    <div class="ramo doble" id="nino1" data-col="7" data-row="1" data-prer="farmaco,rehabili,imagen2,patooral3">Clínica del Niño I</div>
    <div class="ramo doble" id="rehab" data-col="7" data-row="2" data-prer="farmaco,rehabili,cirubucal,oclusion,imagen2,patooral3">Clínica de Rehabilitación Oral</div>
    <div class="ramo doble" id="endo" data-col="7" data-row="3" data-prer="farmaco,rehabili,oclusion,imagen2,patooral3">Clínica de Endodoncia</div>
    <div class="ramo doble" id="perio" data-col="7" data-row="4" data-prer="farmaco,rehabili,oclusion,imagen2,patooral3">Clínica de Periodoncia</div>
    <div class="ramo doble" id="cirutrauma" data-col="5" data-row="5" data-prer="farmaco,cirubucal,imagen2,patooral3">Cirugía y Traumatología Buco Dentaria</div>
    
    <!-- 8° semestre -->
    <div class="ramo" id="ingles1" data-col="8" data-row="6" data-prer="habilidades">Inglés I</div>
    <!-- Clínicas del 7° continúan, no se agregan nuevos ramos -->

    <!-- 9° semestre -->
<div class="ramo doble" id="nino2" data-col="9" data-row="1" data-prer="nino1">
  Clínica del Niño II
</div>
<div class="ramo" id="maxilo" data-col="9" data-row="4" data-prer="cirutrauma">
  Cirugía y Traumatología Máxilo Facial
</div>
<div class="ramo" id="promoprev" data-col="9" data-row="5" data-prer="epidemio,rehabili,nino1,perio">
  Promoción y Prevención
</div>
<div class="ramo doble" id="integral" data-col="9" data-row="2" data-prer="rehab,endo,perio,cirutrauma">
  Clínica Integral del Adulto y Senescente
</div>
<div class="ramo" id="ingles2" data-col="9" data-row="6" data-prer="ingles1">
  Inglés II
</div>

<!-- 10° semestre -->
<div class="ramo" id="legal" data-col="10" data-row="3" data-prer="nino1,rehab,endo,perio,cirubucal">
  Odontología Legal
</div>
<div class="ramo" id="gestion" data-col="10" data-row="5" data-prer="promoprev">
  Gestión en Salud
</div>

<!-- 11° semestre -->
<div class="ramo doble" id="internado" data-col="11" data-row="2" data-prer="legal,gestion">
  Internado Asistencial
</div>
    <div class="ramo" id="invest" data-col="11" data-row="1" data-prer="legal,gestion">
  Metodología de la Investigación
</div>


    
<!-- 12° semestre -->
<div class="ramo" id="seminario" data-col="12" data-row="1" data-prer="invest">
  Seminario de Investigación
</div>

    
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const ramos = document.querySelectorAll(".ramo");
      const progresoGuardado = JSON.parse(localStorage.getItem("mallaAprobada")) || [];

      // Restaurar progreso desde localStorage
      ramos.forEach(ramo => {
        const id = ramo.id;
        const prer = ramo.dataset.prer?.split(",") || [];

        if (prer.length === 0) {
          ramo.classList.add("desbloqueado");
        }

        if (progresoGuardado.includes(id)) {
          ramo.classList.add("aprobado");
        }

        ramo.addEventListener("click", () => {
          if (!ramo.classList.contains("desbloqueado")) return;
          ramo.classList.toggle("aprobado");
          guardarProgreso();
          actualizarDesbloqueos();
        });
      });

      actualizarDesbloqueos();

      function actualizarDesbloqueos() {
        ramos.forEach(ramo => {
          const prer = ramo.dataset.prer?.split(",") || [];
          if (prer.length === 0) return;

          const aprobados = prer.every(id => {
            const nodo = document.getElementById(id);
            return nodo && nodo.classList.contains("aprobado");
          });

          if (aprobados) {
            ramo.classList.add("desbloqueado");
          } else {
            ramo.classList.remove("desbloqueado");
            ramo.classList.remove("aprobado");
          }
        });

        guardarProgreso();
      }

      function guardarProgreso() {
        const aprobados = [...document.querySelectorAll(".ramo.aprobado")].map(r => r.id);
        localStorage.setItem("mallaAprobada", JSON.stringify(aprobados));
      }

      window.reiniciarMalla = function () {
        ramos.forEach(ramo => {
          ramo.classList.remove("aprobado", "desbloqueado");
        });

        ramos.forEach(ramo => {
          const prer = ramo.dataset.prer?.split(",") || [];
          if (prer.length === 0) {
            ramo.classList.add("desbloqueado");
          }
        });

        localStorage.removeItem("mallaAprobada");
      };
    });
  </script>
</body>
</html>
